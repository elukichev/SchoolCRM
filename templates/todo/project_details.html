{% extends 'base.html' %}

{% block title %}
  Проект {{ project.name|truncatechars:30 }}
{% endblock %}

{% block content %}
    <h1>{{ project.name }}</h1>
    <p> {{ project.description }} </p>
    <p> <a href="{% url 'todo:project_edit' project.pk %}">Редактировать проект</a></p>
    <div class="row g-0 text-center">
        <div class="col-sm-6 col-md-8">
            {% for task in tasks %}
            <div class="card m-3 border-dark">
                <div class="card-body">
                    <a href="{% url 'todo:task_details' project.pk task.pk %}"> {{ task.name }} </a> Ответственный: {{ task.executor.get_full_name }}
                    <div class="progress" role="progressbar" aria-label="Basic example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" style="width: {{ progress|get_item:task.pk|get_item:'percent' }}%">Выполнено {{ progress|get_item:task.pk|get_item:'done' }} задачи из {{ progress|get_item:task.pk|get_item:'total' }}</div></div>
                    Дедлайн: {{ task.deadline|date:"d M, Y" }}
                    <a href="{% url 'todo:task_delete' task.project_id.pk task.pk %}"><img src="/static/img/delete.png" class="delete-img"></a>
                </div>
            </div>
            {% endfor %}
        <a href="{% url 'todo:task_create' project.pk %}"><button type="button" class="btn btn-outline-dark">Добавить задачу</button></a>
        </div>
        <div class="col-sm-6 col-md-4">
            <div class="card m-3 border-dark">
                <div class="card-body">
                <h4>Проект курирует: </h4>
                {{ project.author.get_full_name }}
                <hr>
            <h4>Над проектом работают: </h4>
            {% for executor in executors %}
                <p> {{ executor.get_full_name }} </p>
            {% endfor %}
                    <a href="{% url 'todo:add_project_executor' project_id=project.pk %}"><button type="button" class="btn btn-outline-dark">Добавить исполнителя</button></a>
        </div>
            </div>
        </div>
    </div>

{% endblock %}